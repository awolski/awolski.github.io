<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=permissions-policy content="interest-cohort=()"><link rel=stylesheet href=https://awol.ski/style.css><title>Random 'Permission denied (publickey)' error in Travis | Tony Wolski</title><meta name=description content="This morning I hit a random issue in Travis (Pro), in that all of a sudden a build could not clone a GitHub repository:
Installing an SSH key from: default â€¦"><meta name=author content="Tony Wolski"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=referrer content="no-referrer"><link rel=canonical href=https://awol.ski/sudden-permission-denied-publickey-error-in-travis/></head><body><header id=masthead><h1><a href=/ title="Tony Wolski">Tony Wolski</a></h1></header><main><article class=post><header><h1>Random 'Permission denied (publickey)' error in Travis</h1><small>2015-11-11</small></header><p>This morning I hit a random issue in Travis (Pro), in that all of a sudden a build could not clone a GitHub repository:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>Installing an SSH key from: default repository key
Key fingerprint: 5e:fd:38:1f:01:e2:f0:87:8e:77:91:e7:70:37:c0:14
3.68s

$ git clone --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span> --branch<span style=color:#f92672>=</span>my-branch git@github.com:my-organisation/my-repo.git my-organisation/my-repo
Cloning into <span style=color:#e6db74>&#39;my-organisation/my-repo&#39;</span>...
Warning: Permanently added the RSA host key <span style=color:#66d9ef>for</span> IP address <span style=color:#e6db74>&#39;192.30.254.137&#39;</span> to the list of known hosts.
Permission denied <span style=color:#f92672>(</span>publickey<span style=color:#f92672>)</span>.
fatal: Could not read from remote repository.

Please make sure you have the correct access rights and the repository exists.
The command <span style=color:#e6db74>&#34;eval git clone --depth=50 --branch=my-branch git@github.com:my-organisation/my-repo.git my-organisation/my-repo&#34;</span> failed. Retrying, <span style=color:#ae81ff>2</span> of 3.
</code></pre></div><p>I had no idea why this was occurring. As far as I knew nobody had changed any of the settings on GitHub. And all previous builds had succeeded (or failed for other, valid reasons).</p><p>I did a quick inspection and suspiciously there were no deploy keys:</p><p><img src=/assets/img/2015-11-11-no-deploy-keys.png alt=github-deploykey-empty></p><p>Strange. I could have sworn Travis adds a deploy key when you sync a repository. I went to the Travis CI profile page and turned off the repository in question and then back on again.</p><p><img src=/assets/img/2015-11-11-repo-sync.png alt=travis-git-repo-on></p><p>After doing so and kicking off the build again everything seemed back to normal. The build worked, and there was a deploy key in the GitHub repository settings.</p><p><img src=/assets/img/2015-11-11-deploy-key.png alt=github-deploy-key></p><p>Weird.</p><footer>&#171; <a href=https://awol.ski/building-an-aws-ami-with-packer/>Previous</a>
||
<a href=https://awol.ski/making-time-blocking-work-with-google-calendar/>Next</a> &#187;</footer><br><p><strong>Your thoughts?</strong> I'd love to hear them. Please get in <a href=/contact>contact</a>.</p></article></main><footer id=mastfoot><nav><a href=/contact title=Contact>Contact</a></nav></footer></body></html>