<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://awolski.com/style.css><title>The things you discover... httpie and jq | Tony Wolski</title><meta name=description content="Tony Wolski: Sometimes working with technology you feel so far behind the eight ball. Like, how do you not know about some of the awesome tools out there that could have â€¦"><meta name=author content="Tony Wolski"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=referrer content="no-referrer"><meta name=generator content="Hugo 0.69.0"><link rel=canonical href=https://awolski.com/the-things-you-discover-jq-and-httpie/></head><body><section id=masthead><h1><a href=/ title="Tony Wolski">Tony Wolski</a></h1><nav><ul><li><a href=/contact title=Contact>Contact</a></li></ul></nav></section><div id=content><article class=post><header><h1>The things you discover... httpie and jq</h1><small>2016-01-16</small></header><p>Sometimes working with technology you feel so far behind the eight ball. Like, how do you <strong>not</strong> know about some of the awesome tools out there that <em>could</em> have made your life so much easier before now. This week I was introduced to two such tools, <a href=https://github.com/jkbrzt/httpie>httpie</a> and <a href=https://stedolan.github.io/jq/>jq</a>. I just know that the combination of these two command line apps are going to come in real handy.</p><h2 id=httpie>httpie</h2><p>From the homepage:</p><blockquote><p><strong>httpie</strong> is a command line HTTP client. Its goal is to make CLI interaction with web services as human-friendly as possible. It provides a simple http command that allows for sending arbitrary HTTP requests using a simple and natural syntax, and displays colorized output. HTTPie can be used for testing, debugging, and generally interacting with HTTP servers.</p></blockquote><p>I&rsquo;m currently evaluating <a href=https://www.vaultproject.io/>Vault</a> by Hashicorp, working my way through the getting started guide. I wanted to test out the <a href=https://www.vaultproject.io/docs/http/>http api</a> instead of using the command line client. The examples show you can execute a curl command like this to write a secret to vault:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ curl <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -H <span style=color:#e6db74>&#34;X-Vault-Token: f3b09679-3001-009d-2b80-9c306ab81aa6&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -X POST <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -d <span style=color:#e6db74>&#39;{&#34;value&#34;:&#34;bar&#34;}&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    http://127.0.0.1:8200/v1/secret/baz
</code></pre></div><p>With http installed that turns into&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ http --json POST http://127.0.0.1:8200/v1/secret/baz <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    X-Vault-Token:6bf59568-6530-588b-3928-1918f7dc781a <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    value<span style=color:#f92672>=</span>bar
</code></pre></div><p>So much easier! No more curl for me. There&rsquo;s a great <a href=http://ricostacruz.com/cheatsheets/httpie.html>httpie cheatsheet</a> for quick reference, as I found it difficult making switch and not having to enter options for headers and the like.</p><h2 id=jq>jq</h2><p>From the homepage:</p><blockquote><p>jq is a lightweight and flexible command-line JSON processor.</p></blockquote><p>Continuing with the same getting started guide, let&rsquo;s use httpie to pull out the secret we just wrote:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ http GET http://127.0.0.1:8200/v1/secret/baz <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    X-Vault-Token:6bf59568-6530-588b-3928-1918f7dc781a
HTTP/1.1 <span style=color:#ae81ff>200</span> OK
Content-Length: <span style=color:#ae81ff>110</span>
Content-Type: application/json
Date: Sat, <span style=color:#ae81ff>16</span> Jan <span style=color:#ae81ff>2016</span> 21:33:06 GMT

<span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;auth&#34;</span>: null,
    <span style=color:#e6db74>&#34;data&#34;</span>: <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;bar&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;lease_duration&#34;</span>: 2592000,
    <span style=color:#e6db74>&#34;lease_id&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
    <span style=color:#e6db74>&#34;renewable&#34;</span>: false,
    <span style=color:#e6db74>&#34;warnings&#34;</span>: null
<span style=color:#f92672>}</span>
</code></pre></div><p>So what can we do with jq? Well, what if we just want to read the value of the secret we just stored? jq makes that really easy:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ vault read -format<span style=color:#f92672>=</span>json secret/baz | jq -r .data.value
bar
</code></pre></div><p>Awesome! jq is a tool I think I&rsquo;m going to be using a lot, especially in conjunction with httpie. Just check out what&rsquo;s possible on the <a href=https://stedolan.github.io/jq/tutorial/>tutorial</a> page.</p><footer>&#171; <a href=https://awolski.com/my-2015-year-of-writing-in-review/>Previous</a>
||
<a href=https://awolski.com/problem-installing-jq-on-os-x-using-homebrew/>Next</a> &#187;</footer></article><div id=comments><strong>Your thoughts?</strong> I'd love to hear them. Please get in <a href=/contact>contact</a>.</div></div></body></html>