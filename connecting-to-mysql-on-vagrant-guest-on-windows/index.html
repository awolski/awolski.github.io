<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://awol.ski/style.css><title>Connecting to MySQL on Vagrant guest on Windows | Tony Wolski</title><meta name=description content="Last week I set up a Vagrant box with Tomcat, MariaDB and a couple of Java web applications so that our testers could quickly get started on their own private â€¦"><meta name=author content="Tony Wolski"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=referrer content="no-referrer"><link rel=canonical href=https://awol.ski/connecting-to-mysql-on-vagrant-guest-on-windows/></head><body><header id=masthead><h1><a href=/ title="Tony Wolski">Tony Wolski</a></h1><nav><ul><li><a href=/contact title=Contact>Contact</a></li></ul></nav></header><main><article class=post><header><h1>Connecting to MySQL on Vagrant guest on Windows</h1><small>2015-05-12</small></header><p>Last week I set up a Vagrant box with Tomcat, MariaDB and a couple of Java web applications so that our testers could quickly get started on their own private instances. Being able to run locally, upgrade the applications and database when they like will be a real productivity win for us&mldr; I&rsquo;m not saying anything about the efficiency of IT support ;-).</p><p>If you&rsquo;re interested, I&rsquo;ve created a GitHub repository for the Vagrant-Tomcat-MariaDB setup, which you can view <a href=https://github.com/awolski/vagrant-tomcat7-mariadb>here</a>.</p><p>One problem I had a bit of trouble with connecting to the MariaDB database on the VM using our regular MySQL client. We run on Windows here, so SSH is not available without installing another tool like PuTTy or similar. Typically when we create a connection it&rsquo;s using localhost, but becuase the VM is effectively another machine with its own IP address, and you&rsquo;re trying to connect over SSH, things get a bit tricky. It is possible though, and here&rsquo;s how&mldr;</p><h2 id=forward-the-mysqlmariadb-port>Forward the MySQL/MariaDB port</h2><p>First, in your Vagrant script, forward the MySQL port to the host:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>Vagrant.configure<span style=color:#f92672>(</span>2<span style=color:#f92672>)</span> <span style=color:#66d9ef>do</span> |config|
  ...
  config.vm.network <span style=color:#e6db74>&#34;forwarded_port&#34;</span>, guest: 3306, host: <span style=color:#ae81ff>3306</span>
  ...
end
</code></pre></div><h2 id=configure-mysql-to-allow-remote-connections>Configure MySQL to allow remote connections:</h2><p>When your box is up and running, or in your provisioning scripts, configure MySQL/MariaDB on the VM to allow connections from remote machines (i.e. the host):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sudo sed -i <span style=color:#e6db74>&#39;s/bind-address.*/bind-address = 0.0.0.0/&#39;</span> /etc/mysql/my.cnf
$ sudo service mysql restart<span style=color:#e6db74>`</span>
</code></pre></div><h2 id=configure-the-mysql-client-to-connect-over-ssh>Configure the MySQL client to connect over SSH</h2><p>When you&rsquo;re working locally (database and applications on your own machine), you&rsquo;d normally configure a MySQL workbench connection using Standard TCP/IP. However when connecting to your VirtualBoxVM, you&rsquo;ll need to change the connection method and enter a few different parameters.</p><p>If you don&rsquo;t configure ssh in your Vagrant file explicitly, the defaults kick in when you first run <code>vagrant ssh</code> to login to the box (using CygWin or PuTTy), a private_key file is generated in .vagrant/default/virtualbox. You&rsquo;ll uses this as the SSH Key File in your connection settings, as outline below:</p><ul><li><strong>Connection Method</strong>: Standard TCP/IP over SSH</li><li><strong>SSH Hostname</strong>: 127.0.0.1:2222</li><li><strong>SSH Username</strong>: vagrant</li><li><strong>SSH Key File</strong>: &lt;path_to_vagrant_folder>/.vagrant/default/virtualbox/private_key</li><li><strong>MySQL Hostname</strong>: 127.0.0.1</li><li><strong>MySQL Server Port</strong>: 3306 (or whatever port you forwarded to)</li></ul><p><img src=/assets/img/2015-05-12-vagrant-mysql-tcp-over-ssh.png alt="MySQL connection using TCP/IP over SSH"></p><p>Hopefully this helps someone out trying to connect to a MySQL based database inside a Vagrant VM.</p><footer>&#171; <a href=https://awol.ski/blogging-with-google-voice-to-text/>Previous</a>
||
<a href=https://awol.ski/considering-microservices/>Next</a> &#187;</footer><hr><p><strong>Your thoughts?</strong> I'd love to hear them. Please get in <a href=/contact>contact</a>.</p></article></main><footer></footer></body></html>