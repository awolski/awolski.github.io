<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://awolski.com/style.css><title>Specifying the location of shiro.ini | Tony Wolski</title><meta name=description content="I&rsquo;ve been working on switching the identity and security management libraries in one of my applications from Seam Security/PicketLink IDM to Shiro backed â€¦"><meta name=author content="Tony Wolski"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=referrer content="no-referrer"><link rel=canonical href=https://awolski.com/specifying-the-location-of-shiro-ini/></head><body><header id=masthead><h1><a href=/ title="Tony Wolski">Tony Wolski</a></h1><nav><ul><li><a href=/contact title=Contact>Contact</a></li></ul></nav></header><main><article class=post><header><h1>Specifying the location of shiro.ini</h1><small>2014-08-01</small></header><p>I&rsquo;ve been working on switching the identity and security management libraries in one of my applications from <a href=http://docs.jboss.org/seam/3/security/latest/reference/en-US/html/security-identitymanagement.html>Seam Security/PicketLink IDM</a> to <a href=http://shiro.apache.org/>Shiro</a> backed by <a href=https://stormpath.com/>Stormpath</a>. Shiro and Stormpath are really quite easy to set up, and there are some <a href=https://github.com/stormpath/stormpath-shiro/wiki>good guides</a> out there to help you get up and running. For me, everything was going really well in my local development environment, but when I finally pushed these changes to my hosting provider, <a href=http://jelastic.com/>Jelastic</a>, I hit an issue&mldr;</p><p>As per Stormpath&rsquo;s API key instructions, I placed my apiKey.properties file in my <code>user.home</code> home directory on my development machine:</p><blockquote><p>&ldquo;&mldr; This will generate your API Key and download it to your computer as an apiKey.properties file. If you open the file in a text editor, you will see something similar to the following:</p></blockquote><pre><code>apiKey.id = 144JVZINOF5EBNCMG9EXAMPLE
apiKey.secret = lWxOiKqKPNwJmSldbiSkEbkNjgh2uRSNAb+AEXAMPLE
</code></pre><blockquote><p>&ldquo;&mldr; Save this file in a secure location, such as your home directory, in a hidden <code>.stormpath</code> directory. For example:</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ mkdir ~/.stormpath
$ mv ~/Downloads/apiKey.properties ~/.stormpath/
</code></pre></div><p>Then, in your <code>shiro.ini</code> file you specify the location of <code>apiKey.properties</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>stormpathClient.apiKeyFileLocation <span style=color:#f92672>=</span> /Users/awolski/.stormpath/apiKey.properties
</code></pre></div><p>But <code>/Users/awolski/.stormpath</code> doesn&rsquo;t exist in Jelastic (obviously), so specifying a hard-coded location in your <code>WEB-INF/shiro.ini</code> won&rsquo;t work when you need to port your application to another environment.</p><h2 id=environment-specific-shiroini>Environment specific shiro.ini</h2><p>The default location Shiro looks for your *.ini file is <code>"/WEB-INF/shiro.ini"</code>, however I discovered you could override this location by using <code>shiroConfigLocations</code> context parameter, as explained here:</p><blockquote><p>&ldquo;The shiroConfigLocations context-param, if it exists, allows you to specify the config location(s) (resource path(s)) that will be relayed to the instantiated WebEnvironment&mldr;&rdquo;</p></blockquote><p>You could put this in your web.xml, but because my configuration will be environment specific, I put the parameter in Tomcat&rsquo;s context.xml:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;Parameter</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;shiroConfigLocations&#34;</span> <span style=color:#a6e22e>value=</span><span style=color:#e6db74>&#34;file:/opt/tomcat/temp/shiro.ini&#34;</span> <span style=color:#a6e22e>override=</span><span style=color:#e6db74>&#34;false&#34;</span><span style=color:#f92672>/&gt;</span>`
</code></pre></div><p>Then your environment specific shiro configuration can point to a different location for your Stormpath apiKey.properties:</p><pre><code>stormpathClient.apiKeyFileLocation = /opt/tomcat/temp/.stormpath/apiKey.properties`
</code></pre><p>My experience with Shiro, and in particular Stormpath, has been really positive so far. The API is well documented and solves a lot of user management problems straight out of the box with just a little configuration. I especially LOVE Stormpath&rsquo;s <a href=https://stormpath.com/blog/custom-user-data-stormpath-now-beta/>customData</a>, which I can foresee covering all of my identity management needs going forward.</p><p>Check them out, you won&rsquo;t be disappointed!</p><footer>&#171; <a href=https://awolski.com/running-liquibase-against-an-existing-database-part-2/>Previous</a>
||
<a href=https://awolski.com/modern-java-developer/>Next</a> &#187;</footer><hr><p><strong>Your thoughts?</strong> I'd love to hear them. Please get in <a href=/contact>contact</a>.</p></article></main><footer></footer></body></html>